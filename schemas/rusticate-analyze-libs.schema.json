{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/rusticate/schemas/rust_stdlib_inventory.schema.json",
  "title": "Rust Standard Library Inventory",
  "description": "Complete inventory of Rust standard library (std, core, alloc) generated by rusticate-analyze-libs",
  "type": "object",
  "required": ["generated", "rust_version", "sysroot", "libraries", "summary"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "generated": {
      "type": "string",
      "description": "Timestamp when inventory was generated",
      "examples": ["2025-12-14 04:25:48 -08:00"]
    },
    "rust_version": {
      "type": "string",
      "description": "Rust compiler version used",
      "examples": ["rustc 1.88.0 (6b00bc388 2025-06-23)"]
    },
    "sysroot": {
      "type": "string",
      "description": "Path to Rust sysroot",
      "examples": ["/home/user/.rustup/toolchains/1.88.0-x86_64-unknown-linux-gnu"]
    },
    "libraries": {
      "type": "object",
      "description": "Map of library name to library info",
      "additionalProperties": {
        "$ref": "#/$defs/LibraryInfo"
      }
    },
    "summary": {
      "$ref": "#/$defs/Summary"
    }
  },
  "$defs": {
    "LibraryInfo": {
      "type": "object",
      "description": "Information about a single library (core, alloc, or std)",
      "required": ["path", "files", "modules", "types", "traits", "functions", "macros", "constants", "type_aliases", "impls"],
      "properties": {
        "path": {
          "type": "string",
          "description": "Absolute path to library source"
        },
        "files": {
          "type": "array",
          "items": { "$ref": "#/$defs/FileInfo" }
        },
        "modules": {
          "type": "array",
          "description": "Module tree built from lib.rs",
          "items": { "$ref": "#/$defs/ModuleInfo" }
        },
        "prelude": {
          "oneOf": [
            { "$ref": "#/$defs/PreludeInfo" },
            { "type": "null" }
          ],
          "description": "What's auto-imported into every Rust program"
        },
        "types": {
          "type": "array",
          "items": { "$ref": "#/$defs/TypeInfo" }
        },
        "traits": {
          "type": "array",
          "items": { "$ref": "#/$defs/TraitInfo" }
        },
        "functions": {
          "type": "array",
          "items": { "$ref": "#/$defs/FunctionInfo" }
        },
        "macros": {
          "type": "array",
          "items": { "$ref": "#/$defs/MacroInfo" }
        },
        "constants": {
          "type": "array",
          "items": { "$ref": "#/$defs/ConstantInfo" }
        },
        "type_aliases": {
          "type": "array",
          "items": { "$ref": "#/$defs/TypeAliasInfo" }
        },
        "impls": {
          "type": "array",
          "items": { "$ref": "#/$defs/ImplInfo" }
        }
      }
    },
    "ModuleInfo": {
      "type": "object",
      "description": "A module in the module tree",
      "required": ["name", "path", "is_public", "source_file", "child_modules", "re_exports", "items"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Module name",
          "examples": ["option", "vec", "iter"]
        },
        "path": {
          "type": "string",
          "description": "Full module path",
          "examples": ["core::option", "alloc::vec"]
        },
        "is_public": {
          "type": "boolean",
          "description": "pub mod vs mod"
        },
        "source_file": {
          "type": "string",
          "description": "File that defines this module"
        },
        "child_modules": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Names of child modules declared in this module"
        },
        "re_exports": {
          "type": "array",
          "items": { "$ref": "#/$defs/ReExportInfo" },
          "description": "pub use statements in this module"
        },
        "items": {
          "$ref": "#/$defs/ModuleItems",
          "description": "Items defined directly in this module"
        }
      }
    },
    "ReExportInfo": {
      "type": "object",
      "description": "A pub use re-export",
      "required": ["name", "source_path", "kind"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Public name (or * for glob)",
          "examples": ["Option", "Vec", "*"]
        },
        "source_path": {
          "type": "string",
          "description": "Where it comes from",
          "examples": ["core::option::Option", "alloc::vec::Vec"]
        },
        "kind": {
          "type": "string",
          "enum": ["type", "trait", "type/trait", "function", "macro", "module", "all"],
          "description": "Kind of item being re-exported. 'type/trait' means we cannot distinguish from pub use syntax alone"
        }
      }
    },
    "ModuleItems": {
      "type": "object",
      "description": "Items defined directly in a module",
      "required": ["types", "traits", "functions", "macros", "constants", "type_aliases"],
      "properties": {
        "types": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Type names defined here"
        },
        "traits": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Trait names defined here"
        },
        "functions": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Function names defined here"
        },
        "macros": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Macro names defined here"
        },
        "constants": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Constant names defined here"
        },
        "type_aliases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Type alias names defined here"
        }
      }
    },
    "PreludeInfo": {
      "type": "object",
      "description": "What's auto-imported into every Rust program",
      "required": ["module_path", "source_file", "types", "traits", "macros", "functions"],
      "properties": {
        "module_path": {
          "type": "string",
          "description": "Full module path",
          "examples": ["std::prelude::rust_2021"]
        },
        "source_file": {
          "type": "string",
          "description": "File that defines the prelude"
        },
        "types": {
          "type": "array",
          "items": { "$ref": "#/$defs/PreludeItem" },
          "description": "Types auto-imported (Option, Result, Vec, etc.)"
        },
        "traits": {
          "type": "array",
          "items": { "$ref": "#/$defs/PreludeItem" },
          "description": "Traits auto-imported (Clone, Iterator, etc.)"
        },
        "macros": {
          "type": "array",
          "items": { "$ref": "#/$defs/PreludeItem" },
          "description": "Macros auto-imported"
        },
        "functions": {
          "type": "array",
          "items": { "$ref": "#/$defs/PreludeItem" },
          "description": "Functions auto-imported"
        }
      }
    },
    "PreludeItem": {
      "type": "object",
      "description": "An item in the prelude",
      "required": ["name", "source_path"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Public name",
          "examples": ["Option", "Vec", "Clone"]
        },
        "source_path": {
          "type": "string",
          "description": "Where it comes from",
          "examples": ["core::option::Option", "alloc::vec::Vec"]
        }
      }
    },
    "FileInfo": {
      "type": "object",
      "description": "Information about a source file",
      "required": ["path", "module", "line_count", "type_count", "trait_count", "function_count", "impl_count"],
      "properties": {
        "path": {
          "type": "string",
          "description": "Relative path within library"
        },
        "module": {
          "type": "string",
          "description": "Module path (e.g., src::vec::mod)"
        },
        "line_count": {
          "type": "integer",
          "minimum": 0
        },
        "type_count": {
          "type": "integer",
          "minimum": 0
        },
        "trait_count": {
          "type": "integer",
          "minimum": 0
        },
        "function_count": {
          "type": "integer",
          "minimum": 0
        },
        "impl_count": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "TypeInfo": {
      "type": "object",
      "description": "A struct or enum definition",
      "required": ["name", "qualified_path", "kind", "is_generic", "is_unsafe", "derives", "methods", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Type name",
          "examples": ["Vec", "Option", "Result"]
        },
        "qualified_path": {
          "type": "string",
          "description": "Fully qualified path",
          "examples": ["alloc::vec::Vec", "core::option::Option"]
        },
        "kind": {
          "type": "string",
          "enum": ["struct", "enum"],
          "description": "Whether this is a struct or enum"
        },
        "is_generic": {
          "type": "boolean",
          "description": "Has type parameters"
        },
        "is_unsafe": {
          "type": "boolean",
          "description": "Requires unsafe to construct/use"
        },
        "derives": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Derived traits",
          "examples": [["Clone", "Debug", "PartialEq"]]
        },
        "methods": {
          "type": "array",
          "items": { "$ref": "#/$defs/MethodInfo" },
          "description": "Inherent methods (from impl blocks)"
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "MethodInfo": {
      "type": "object",
      "description": "An inherent method on a type",
      "required": ["name", "is_generic", "is_unsafe", "can_panic", "must_use", "is_const", "takes_self"],
      "properties": {
        "name": {
          "type": "string"
        },
        "is_generic": {
          "type": "boolean",
          "description": "Has type parameters beyond Self"
        },
        "is_unsafe": {
          "type": "boolean"
        },
        "can_panic": {
          "type": "boolean",
          "description": "May panic at runtime (unwrap, expect, index, etc.)"
        },
        "must_use": {
          "type": "boolean",
          "description": "Has #[must_use] attribute"
        },
        "is_const": {
          "type": "boolean",
          "description": "Is a const fn"
        },
        "takes_self": {
          "type": "string",
          "enum": ["self", "&self", "&mut self", "none"],
          "description": "How self is taken, or 'none' for associated functions"
        }
      }
    },
    "TraitInfo": {
      "type": "object",
      "description": "A trait definition",
      "required": ["name", "qualified_path", "is_unsafe", "is_auto", "supertraits", "associated_types", "associated_consts", "methods", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "examples": ["Iterator", "Clone", "Debug"]
        },
        "qualified_path": {
          "type": "string",
          "examples": ["core::iter::Iterator"]
        },
        "is_unsafe": {
          "type": "boolean",
          "description": "Unsafe trait"
        },
        "is_auto": {
          "type": "boolean",
          "description": "Auto trait (Send, Sync, Unpin)"
        },
        "supertraits": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required supertraits"
        },
        "associated_types": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Associated type names",
          "examples": [["Item", "IntoIter"]]
        },
        "associated_consts": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Associated constant names"
        },
        "methods": {
          "type": "array",
          "items": { "$ref": "#/$defs/TraitMethodInfo" }
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "TraitMethodInfo": {
      "type": "object",
      "description": "A method defined in a trait",
      "required": ["name", "is_generic", "is_unsafe", "has_default", "can_panic", "must_use"],
      "properties": {
        "name": {
          "type": "string"
        },
        "is_generic": {
          "type": "boolean"
        },
        "is_unsafe": {
          "type": "boolean"
        },
        "has_default": {
          "type": "boolean",
          "description": "Has a default implementation"
        },
        "can_panic": {
          "type": "boolean"
        },
        "must_use": {
          "type": "boolean"
        }
      }
    },
    "FunctionInfo": {
      "type": "object",
      "description": "A free (top-level) function",
      "required": ["name", "qualified_path", "is_generic", "is_unsafe", "can_panic", "must_use", "is_const", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "examples": ["drop", "swap", "replace"]
        },
        "qualified_path": {
          "type": "string",
          "examples": ["core::mem::drop"]
        },
        "is_generic": {
          "type": "boolean"
        },
        "is_unsafe": {
          "type": "boolean"
        },
        "can_panic": {
          "type": "boolean"
        },
        "must_use": {
          "type": "boolean"
        },
        "is_const": {
          "type": "boolean"
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "MacroInfo": {
      "type": "object",
      "description": "A macro definition",
      "required": ["name", "qualified_path", "kind", "is_exported", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "examples": ["vec", "println", "format"]
        },
        "qualified_path": {
          "type": "string",
          "examples": ["alloc::vec", "std::println"]
        },
        "kind": {
          "type": "string",
          "enum": ["declarative", "procedural"],
          "description": "macro_rules! vs proc_macro"
        },
        "is_exported": {
          "type": "boolean",
          "description": "Has #[macro_export]"
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "ConstantInfo": {
      "type": "object",
      "description": "A constant or static",
      "required": ["name", "qualified_path", "const_type", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "examples": ["MAX", "MIN", "PI"]
        },
        "qualified_path": {
          "type": "string",
          "examples": ["core::u32::MAX", "core::f64::consts::PI"]
        },
        "const_type": {
          "type": "string",
          "description": "The type of the constant",
          "examples": ["u32", "f64", "usize"]
        },
        "value": {
          "type": ["string", "null"],
          "description": "The value if it's a simple literal"
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "TypeAliasInfo": {
      "type": "object",
      "description": "A type alias",
      "required": ["name", "qualified_path", "target", "source_file", "source_line"],
      "properties": {
        "name": {
          "type": "string",
          "examples": ["Result"]
        },
        "qualified_path": {
          "type": "string",
          "examples": ["std::io::Result"]
        },
        "target": {
          "type": "string",
          "description": "What the alias expands to",
          "examples": ["Result<T, Error>"]
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "ImplInfo": {
      "type": "object",
      "description": "An impl block (inherent or trait)",
      "required": ["impl_type", "is_unsafe", "is_blanket", "is_forwarding", "is_bridge", "methods", "source_file", "source_line"],
      "properties": {
        "impl_type": {
          "type": "string",
          "description": "The type being implemented",
          "examples": ["Vec<T>", "Option<T>", "&str"]
        },
        "trait_name": {
          "type": ["string", "null"],
          "description": "Trait being implemented, or null for inherent impl",
          "examples": ["Iterator", "Clone", null]
        },
        "is_unsafe": {
          "type": "boolean"
        },
        "is_blanket": {
          "type": "boolean",
          "description": "Blanket impl - generic impl applying to multiple types (impl<T> Trait for SomeType<T>)"
        },
        "is_forwarding": {
          "type": "boolean",
          "description": "Forwarding impl - blanket impl for wrapper types (&T, Box<T>, Arc<T>, etc.) that propagates traits through the wrapper"
        },
        "is_bridge": {
          "type": "boolean",
          "description": "Bridge impl - blanket impl where having trait A gives you trait B for free (impl<T: TraitA> TraitB for T)"
        },
        "where_clause": {
          "type": ["string", "null"],
          "description": "Where clause if present"
        },
        "methods": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Names of methods in this impl block"
        },
        "source_file": {
          "type": "string"
        },
        "source_line": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "Summary": {
      "type": "object",
      "description": "Aggregate counts across all libraries",
      "required": [
        "total_libraries",
        "total_files",
        "total_modules",
        "total_public_modules",
        "total_re_exports",
        "total_prelude_items",
        "total_types",
        "total_traits",
        "total_type_methods",
        "total_trait_methods",
        "total_functions",
        "total_macros",
        "total_constants",
        "total_type_aliases",
        "total_impls",
        "total_blanket_impls",
        "total_forwarding_impls",
        "total_bridge_impls"
      ],
      "properties": {
        "total_libraries": {
          "type": "integer",
          "minimum": 0
        },
        "total_files": {
          "type": "integer",
          "minimum": 0
        },
        "total_modules": {
          "type": "integer",
          "minimum": 0,
          "description": "Total modules in module tree"
        },
        "total_public_modules": {
          "type": "integer",
          "minimum": 0,
          "description": "Public modules (pub mod)"
        },
        "total_re_exports": {
          "type": "integer",
          "minimum": 0,
          "description": "Total pub use re-exports"
        },
        "total_prelude_items": {
          "type": "integer",
          "minimum": 0,
          "description": "Total items in preludes"
        },
        "total_types": {
          "type": "integer",
          "minimum": 0
        },
        "total_traits": {
          "type": "integer",
          "minimum": 0
        },
        "total_type_methods": {
          "type": "integer",
          "minimum": 0,
          "description": "Methods on types (from inherent impls)"
        },
        "total_trait_methods": {
          "type": "integer",
          "minimum": 0,
          "description": "Methods defined in traits"
        },
        "total_functions": {
          "type": "integer",
          "minimum": 0,
          "description": "Free (top-level) functions"
        },
        "total_macros": {
          "type": "integer",
          "minimum": 0
        },
        "total_constants": {
          "type": "integer",
          "minimum": 0
        },
        "total_type_aliases": {
          "type": "integer",
          "minimum": 0
        },
        "total_impls": {
          "type": "integer",
          "minimum": 0
        },
        "total_blanket_impls": {
          "type": "integer",
          "minimum": 0,
          "description": "Total blanket impls (generic impl applying to multiple types)"
        },
        "total_forwarding_impls": {
          "type": "integer",
          "minimum": 0,
          "description": "Total forwarding impls (blanket impls for wrapper types)"
        },
        "total_bridge_impls": {
          "type": "integer",
          "minimum": 0,
          "description": "Total bridge impls (having trait A gives you trait B)"
        }
      }
    }
  }
}

